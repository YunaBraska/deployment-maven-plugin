---
platform: linux
image_resource:
  type: docker-image
  source:
    repository: ((docker-url))/maven3.6
    username: ((docker-user))
    password: ((docker-password))
inputs:
  - name: git_gpg
run:
  path: sh
  user: root
  args:
    - -exc
    - |
      export DEPLOY_URL=https://((nexus-user)):((nexus-password))@artifactory.yuna.berlin:443/libs-release-local
      export GPG_PASSPHRASE=((gpg-pass))

      ./install-dependencies.sh
      maven clean install -DskipTests

      mvn berlin.yuna:deployment-maven-plugin:12.0.2:run -Dclean -Dupdate.major -Dupdate.plugins -Dtest.run -Dbuilder -Dproperties.print

      mvn berlin.yuna:deployment-maven-plugin:12.0.2:run -Djava.doc -Djava.source -Ddeploy -Dtag
